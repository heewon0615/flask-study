## 3.1 데이터 베이스

Flask에서 DB와 연결을 하려면 여러 방법이 있지만, 일반적으로 많이 사용되는것은 SQL-Alchemy를 사용하여 연결하는 것이다. SQL-Alchemy는 객체-관계 매핑을 제공하여 파이썬 클래스를 데이터베이스 테이블과 연결을 통해 보다 직관적이고 유지관리를 쉽게 해준다. 

### 3.1.1 플라스크와 MySQL 연동
**[플라스크 애플리케이션과 SQLAlchemy 설정]**
db_name이라는 데이터베이스를 생성한 후 다음 플라스크 코드를 작성한다.
```
from flask import Flask
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://chloe:password@host/db_name'
db=SQLAlchemy(app)
```

**[User 모델 생성]**
User 모델 생성은 데이터베이스에 정의한 테이블을 생성하는 것이다. 기본적으로 SQLAlchemy는 모델 클래스의 이름을 소문자화하여 테이블 이름으로 사용한다. 

```
# User 모델 생성
class User(db.Model):
    # 테이블 이름 직접 지정 (이 부분을 생략하면 기본적으로 클래스 이름을 소문자화한 'user'가 된다.)
    __tablename__ = 'users'
    # 컬럼 정의
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)

    # __repr__ : 객체의 문자열 표현을 정의, 콘솔에 객체를 출력할 때 이 메서드가 반환하는 형식대로 출력됨
    def __repr__(self):
        return '<User &r>' % self.username
```
플라스크 애플리케이션은 실행될 때 특정한 실행 환경, 즉 **'컨텍스트'**를 가진다. 이 컨텍스트는 현재 애플리케이션이나 요청에 대한 정보를 담고 있으며, 애플리케이션 레벨의 컨텍스트를 '애플리케이션 컨텍스트'라고 한다. SQLAlchemy를 사용하여 DB와 상호작용할 때 이 애플리케이션 컨텍스트 안에서 실행해야 할 작업들이 있다. 
애플리케이션 컨텍스트와 함께 사용하면 **create_all() 메서드**는 현재 애플리케이션의 데이터베이스 설정에 따라 적절한 데이터베이스에 테이블들을 생성한다. 이렇게 하면 모든 모델에 대한 테이블이 데이터베이스에 성공적으로 생성될 수 있도록 보장할 수 있다. 

```    
    # 애플리케이션 컨텍스트 안에서 DB 테이블을 생성
    with app.app_context():
        # db.create_all() 메서드는 모델에 정의된 모든 테이블을 데이터베이스에 생성
        db.create_all()
```

### CRUD 구현
CRUD는 Create, Read, Update, Delete의 약자로, 데이터베이스에서 가장 기본적인 작업을 의미한다. SQLAlchemy를 통해 이러한 작업을 쉽게 구현할 수 있다. 
